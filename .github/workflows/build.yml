name: Lineage OS Building
on: workflow_dispatch
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Space Pre
        run: |
          echo "======================="
          echo "Space usage:"
          echo "======================="
          df -h
      - name: Install and uninstall packages
        env:
          DEBIAN_FRONTEND: noninteractive
        run: |
          docker rmi `docker images -q`
          sudo snap remove --purge lxd
          sudo snap remove --purge core20
          sudo snap remove --purge snapd
          sudo -E apt -y autoremove --purge snapd
          sudo sh -c "echo Package: snapd > /etc/apt/preferences.d/nosnap.pref"
          sudo sh -c "echo Pin: release a=* >> /etc/apt/preferences.d/nosnap.pref"
          sudo sh -c "echo Pin-Priority: -10 >> /etc/apt/preferences.d/nosnap.pref"
          sudo -E apt-mark auto accountsservice acl adduser adoptium-ca-certificates adoptopenjdk-11-hotspot adoptopenjdk-8-hotspot adwaita-icon-theme alsa-topology-conf alsa-ucm-conf ant-optional ant apache2-bin apache2-data apache2-utils apache2 apparmor apport-symptoms apport aria2 aspnetcore-runtime-3.1 aspnetcore-runtime-5.0 aspnetcore-runtime-6.0 aspnetcore-targeting-pack-3.1 aspnetcore-targeting-pack-5.0 aspnetcore-targeting-pack-6.0 at autoconf automake autotools-dev azure-cli base-files base-passwd bcache-tools bind9-dnsutils bind9-host bind9-libs binfmt-support binutils-common binutils-x86-64-linux-gnu binutils bolt brotli bsdmainutils bsdutils btrfs-progs buildah busybox-initramfs busybox-static byobu bzip2 ca-certificates-mono ca-certificates catatonit cgroup-tools chrony chrpath cifs-utils clang-10 clang-11 clang-12 clang-format-10 clang-format-11 clang-format-12 cloud-guest-utils cloud-init cloud-initramfs-copymods cloud-initramfs-dyn-netconf command-not-found conmon console-setup-linux console-setup containernetworking-plugins containers-common coreutils cpio cpp-10 cpp-9 cpp criu cron crun cryptsetup-bin cryptsetup-initramfs cryptsetup-run cryptsetup dash dbus-user-session dbus dconf-gsettings-backend dconf-service debconf-i18n debconf debianutils debugedit dictionaries-common diffutils dirmngr distro-info-data distro-info dmeventd dmidecode dmsetup dns-root-data dnsmasq-base dnsutils dosfstools dotnet-apphost-pack-3.1 dotnet-apphost-pack-5.0 dotnet-apphost-pack-6.0 dotnet-host dotnet-hostfxr-3.1 dotnet-hostfxr-5.0 dotnet-hostfxr-6.0 dotnet-runtime-3.1 dotnet-runtime-5.0 dotnet-runtime-6.0 dotnet-runtime-deps-3.1 dotnet-runtime-deps-5.0 dotnet-runtime-deps-6.0 dotnet-sdk-3.1 dotnet-sdk-5.0 dotnet-sdk-6.0 dotnet-targeting-pack-3.1 dotnet-targeting-pack-5.0 dotnet-targeting-pack-6.0 e2fsprogs eatmydata ed efibootmgr eject emacsen-common esl-erlang ethtool fakeroot fdisk file finalrd firebird3.0-common-doc firebird3.0-common firefox fontconfig-config fontconfig fonts-dejavu-core fonts-dejavu-extra fonts-dejavu fonts-lato fonts-liberation fonts-noto-color-emoji fonts-ubuntu-console freetds-common friendly-recovery ftp fuse-overlayfs fuse3 fwupd-signed fwupd g++-10 g++-9 g++ gawk gcc-10-base gcc-10 gcc-11-base gcc-9-base gcc-9 gcc gconf2-common gdisk gettext-base gfortran-10 gfortran-9 gfortran gh gir1.2-freedesktop gir1.2-gdkpixbuf-2.0 gir1.2-glib-2.0 gir1.2-packagekitglib-1.0 gir1.2-rsvg-2.0 gir1.2-secret-1 git-ftp git-lfs git-man glib-networking-common glib-networking-services glib-networking gnupg-l10n gnupg-utils gnupg2 google-chrome-stable google-cloud-sdk gpg-agent gpg-wks-client gpg-wks-server gpg gpgconf gpgsm gpgv grep groff-base grub-common grub-efi-amd64-bin grub-efi-amd64-signed grub-gfxpayload-lists grub-pc-bin grub-pc grub2-common gsettings-desktop-schemas gtk-update-icon-cache gzip haveged hdparm hhvm hicolor-icon-theme hostname htop humanity-icon-theme hunspell-en-us icu-devtools imagemagick-6-common imagemagick-6.q16 info init-system-helpers init initramfs-tools-bin initramfs-tools-core initramfs-tools install-info iproute2 iptables iputils-ping iputils-tracepath irqbalance isc-dhcp-client isc-dhcp-common iso-codes java-common javascript-common jq kbd keyboard-configuration keyutils klibc-utils kmod kpartx krb5-locales landscape-common language-selector-common less lib32gcc-s1 lib32stdc++6 lib32z1 libaccountsservice0 libacl1 libaio1 libapparmor1 libappstream4 libapr1 libaprutil1-dbd-sqlite3 libaprutil1-ldap libaprutil1 libarchive13 libargon2-1 libaria2-0 libasan5 libasan6 libasn1-8-heimdal libasound2-data libasound2 libaspell15 libassuan0 libatasmart4 libatk-bridge2.0-0 libatk1.0-0 libatk1.0-data libatm1 libatomic1 libatspi2.0-0 libattr1 libaudit-common libaudit1 libauthen-sasl-perl libavahi-client3 libavahi-common-data libavahi-common3 libbinutils libblas-dev libblas3 libblkid-dev libblkid1 libblockdev-crypto2 libblockdev-fs2 libblockdev-loop2 libblockdev-part-err2 libblockdev-part2 libblockdev-swap2 libblockdev-utils2 libblockdev2 libboost-context1.71.0 libboost-filesystem1.71.0 libboost-program-options1.71.0 libboost-thread1.71.0 libbrotli1 libbsd0 libburn4 libbz2-1.0 libbz2-dev libc++-10-dev libc++-dev libc++1-10 libc++abi-10-dev libc++abi-dev libc++abi1-10 libc-ares2 libc-bin libc-client2007e libc-dev-bin libc6-dev libc6-i386 libc6 libcairo-gobject2 libcairo-script-interpreter2 libcairo2-dev libcairo2 libcanberra0 libcap-ng0 libcap2-bin libcap2 libcbor0.6 libcc1-0 libcgi-fast-perl libcgi-pm-perl libcgroup1 libclang-common-10-dev libclang-common-11-dev libclang-common-12-dev libclang-cpp10 libclang-cpp11 libclang-cpp12 libclang1-10 libclang1-11 libclang1-12 libcolord2 libcom-err2 libcommon-sense-perl libcrypt-dev libcrypt1 libcryptsetup12 libctf-nobfd0 libctf0 libcups2 libcurl3-gnutls libcurl4 libdata-dump-perl libdatrie1 libdb5.3 libdbus-1-3 libdbus-glib-1-2 libdbusmenu-glib4 libdbusmenu-gtk3-4 libdconf1 libdebconfclient0 libdevmapper-event1.02.1 libdevmapper1.02.1 libdjvulibre-dev libdjvulibre-text libdjvulibre21 libdns-export1109 libdrm-amdgpu1 libdrm-common libdrm-intel1 libdrm-nouveau2 libdrm-radeon1 libdrm2 libdw1 libdwarf1 libeatmydata1 libedit2 libefiboot1 libefivar1 libelf1 libenchant-2-2 libencode-locale-perl libepoxy0 liberror-perl libestr0 libevent-2.1-7 libevent-core-2.1-7 libevent-pthreads-2.1-7 libexif-dev libexif12 libexpat1-dev libexpat1 libext2fs2 libfakeroot libfastjson4 libfbclient2 libfcgi-perl libfdisk1 libffi-dev libffi7 libfftw3-double3 libfido2-1 libfile-desktopentry-perl libfile-listing-perl libfile-mimeinfo-perl libfl2 libfont-afm-perl libfontconfig1-dev libfontconfig1 libfontenc1 libfreetype-dev libfreetype6-dev libfreetype6 libfribidi0 libfuse2 libfuse3-3 libfwupd2 libfwupdplugin1 libfwupdplugin5 libgbm-dev libgbm1 libgc1c2 libgcab-1.0-0 libgcc-10-dev libgcc-9-dev libgcc-s1 libgconf-2-4 libgcrypt20 libgd3 libgdbm-compat4 libgdbm6 libgdiplus libgdk-pixbuf2.0-0 libgdk-pixbuf2.0-bin libgdk-pixbuf2.0-common libgdk-pixbuf2.0-dev libgflags2.2 libgfortran-10-dev libgfortran-9-dev libgfortran5 libgif7 libgirepository-1.0-1 libgl1-mesa-dri libgl1 libglapi-mesa libglib2.0-0 libglib2.0-bin libglib2.0-data libglib2.0-dev-bin libglib2.0-dev libglvnd0 libglx-mesa0 libglx0 libgmp-dev libgmp10 libgmpxx4ldbl libgnutls30 libgomp1 libgoogle-glog0v5 libgpg-error0 libgpgme11 libgpm2 libgraphite2-3 libgsl-dev libgsl23 libgslcblas0 libgssapi-krb5-2 libgssapi3-heimdal libgstreamer1.0-0 libgtk-3-0 libgtk-3-common libgudev-1.0-0 libgusb2 libharfbuzz0b libhavege1 libhcrypto4-heimdal libheimbase1-heimdal libheimntlm0-heimdal libhogweed5 libhtml-form-perl libhtml-format-perl libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl libhtml-tree-perl libhttp-cookies-perl libhttp-daemon-perl libhttp-date-perl libhttp-message-perl libhttp-negotiate-perl libhunspell-1.7-0 libhx509-5-heimdal libice-dev libice6 libicu-dev libicu66 libidn11 libidn2-0 libilmbase-dev libilmbase24 libio-html-perl libio-socket-ssl-perl libio-stringy-perl libip4tc2 libip6tc2 libipc-system-simple-perl libisc-export1105 libisl22 libisns0 libisoburn1 libisofs6 libitm1 libjansson4 libjbig-dev libjbig0 libjcat1 libjemalloc2 libjpeg-dev libjpeg-turbo8-dev libjpeg-turbo8 libjpeg8-dev libjpeg8 libjq1 libjs-jquery libjs-xmlextras libjson-c4 libjson-glib-1.0-0 libjson-glib-1.0-common libjson-perl libjson-xs-perl libjte2 libk5crypto3 libkeyutils1 libklibc libkmod2 libkrb5-26-heimdal libkrb5-3 libkrb5support0 libksba8 liblapack-dev liblapack3 liblcms2-2 liblcms2-dev libldap-2.4-2 libldap-common liblldb-10 liblldb-11 liblldb-12 libllvm10 libllvm11 libllvm12 liblmdb0 liblocale-gettext-perl liblqr-1-0-dev liblqr-1-0 liblsan0 libltdl-dev libltdl7 liblua5.2-0 liblvm2cmd2.03 liblwp-mediatypes-perl liblwp-protocol-https-perl liblz4-1 liblzma-dev liblzma5 liblzo2-2 libmagic-dev libmagic-mgc libmagic1 libmagickcore-6-arch-config libmagickcore-6-headers libmagickcore-6.q16-6-extra libmagickcore-6.q16-6 libmagickcore-6.q16-dev libmagickcore-dev libmagickwand-6-headers libmagickwand-6.q16-6 libmagickwand-6.q16-dev libmagickwand-dev libmailtools-perl libmaxminddb0 libmbim-glib4 libmbim-proxy libmcrypt4 libmecab2 libmediainfo0v5 libmemcached11 libmm-glib0 libmms0 libmnl0 libmono-2.0-1 libmono-2.0-dev libmono-accessibility4.0-cil libmono-cairo4.0-cil libmono-cecil-private-cil libmono-cil-dev libmono-codecontracts4.0-cil libmono-compilerservices-symbolwriter4.0-cil libmono-corlib4.5-cil libmono-cscompmgd0.0-cil libmono-csharp4.0c-cil libmono-custommarshalers4.0-cil libmono-data-tds4.0-cil libmono-db2-1.0-cil libmono-debugger-soft4.0a-cil libmono-http4.0-cil libmono-i18n-cjk4.0-cil libmono-i18n-mideast4.0-cil libmono-i18n-other4.0-cil libmono-i18n-rare4.0-cil libmono-i18n-west4.0-cil libmono-i18n4.0-all libmono-i18n4.0-cil libmono-ldap4.0-cil libmono-management4.0-cil libmono-messaging-rabbitmq4.0-cil libmono-messaging4.0-cil libmono-microsoft-build-engine4.0-cil libmono-microsoft-build-framework4.0-cil libmono-microsoft-build-tasks-v4.0-4.0-cil libmono-microsoft-build-utilities-v4.0-4.0-cil libmono-microsoft-build4.0-cil libmono-microsoft-csharp4.0-cil libmono-microsoft-visualc10.0-cil libmono-microsoft-web-infrastructure1.0-cil libmono-oracle4.0-cil libmono-parallel4.0-cil libmono-peapi4.0a-cil libmono-posix4.0-cil libmono-profiler libmono-rabbitmq4.0-cil libmono-relaxng4.0-cil libmono-security4.0-cil libmono-sharpzip4.84-cil libmono-simd4.0-cil libmono-smdiagnostics0.0-cil libmono-sqlite4.0-cil libmono-system-componentmodel-composition4.0-cil libmono-system-componentmodel-dataannotations4.0-cil libmono-system-configuration-install4.0-cil libmono-system-configuration4.0-cil libmono-system-core4.0-cil libmono-system-data-datasetextensions4.0-cil libmono-system-data-entity4.0-cil libmono-system-data-linq4.0-cil libmono-system-data-services-client4.0-cil libmono-system-data-services4.0-cil libmono-system-data4.0-cil libmono-system-deployment4.0-cil libmono-system-design4.0-cil libmono-system-drawing-design4.0-cil libmono-system-drawing4.0-cil libmono-system-dynamic4.0-cil libmono-system-enterpriseservices4.0-cil libmono-system-identitymodel-selectors4.0-cil libmono-system-identitymodel4.0-cil libmono-system-io-compression-filesystem4.0-cil libmono-system-io-compression4.0-cil libmono-system-json-microsoft4.0-cil libmono-system-json4.0-cil libmono-system-ldap-protocols4.0-cil libmono-system-ldap4.0-cil libmono-system-management4.0-cil libmono-system-messaging4.0-cil libmono-system-net-http-formatting4.0-cil libmono-system-net-http-webrequest4.0-cil libmono-system-net-http4.0-cil libmono-system-net4.0-cil libmono-system-numerics-vectors4.0-cil libmono-system-numerics4.0-cil libmono-system-reactive-core2.2-cil libmono-system-reactive-debugger2.2-cil libmono-system-reactive-experimental2.2-cil libmono-system-reactive-interfaces2.2-cil libmono-system-reactive-linq2.2-cil libmono-system-reactive-observable-aliases0.0-cil libmono-system-reactive-platformservices2.2-cil libmono-system-reactive-providers2.2-cil libmono-system-reactive-runtime-remoting2.2-cil libmono-system-reactive-windows-forms2.2-cil libmono-system-reactive-windows-threading2.2-cil libmono-system-reflection-context4.0-cil libmono-system-runtime-caching4.0-cil libmono-system-runtime-durableinstancing4.0-cil libmono-system-runtime-serialization-formatters-soap4.0-cil libmono-system-runtime-serialization4.0-cil libmono-system-runtime4.0-cil libmono-system-security4.0-cil libmono-system-servicemodel-activation4.0-cil libmono-system-servicemodel-discovery4.0-cil libmono-system-servicemodel-internals0.0-cil libmono-system-servicemodel-routing4.0-cil libmono-system-servicemodel-web4.0-cil libmono-system-servicemodel4.0a-cil libmono-system-serviceprocess4.0-cil libmono-system-threading-tasks-dataflow4.0-cil libmono-system-transactions4.0-cil libmono-system-web-abstractions4.0-cil libmono-system-web-applicationservices4.0-cil libmono-system-web-dynamicdata4.0-cil libmono-system-web-extensions-design4.0-cil libmono-system-web-extensions4.0-cil libmono-system-web-http-selfhost4.0-cil libmono-system-web-http-webhost4.0-cil libmono-system-web-http4.0-cil libmono-system-web-mobile4.0-cil libmono-system-web-mvc3.0-cil libmono-system-web-razor2.0-cil libmono-system-web-regularexpressions4.0-cil libmono-system-web-routing4.0-cil libmono-system-web-services4.0-cil libmono-system-web-webpages-deployment2.0-cil libmono-system-web-webpages-razor2.0-cil libmono-system-web-webpages2.0-cil libmono-system-web4.0-cil libmono-system-windows-forms-datavisualization4.0a-cil libmono-system-windows-forms4.0-cil libmono-system-windows4.0-cil libmono-system-workflow-activities4.0-cil libmono-system-workflow-componentmodel4.0-cil libmono-system-workflow-runtime4.0-cil libmono-system-xaml4.0-cil libmono-system-xml-linq4.0-cil libmono-system-xml-serialization4.0-cil libmono-system-xml4.0-cil libmono-system4.0-cil libmono-tasklets4.0-cil libmono-webbrowser4.0-cil libmono-webmatrix-data4.0-cil libmono-windowsbase4.0-cil libmono-xbuild-tasks4.0-cil libmonoboehm-2.0-1 libmonosgen-2.0-1 libmonosgen-2.0-dev libmpc3 libmpdec2 libmpfr6 libmspack0 libmysqlclient-dev libmysqlclient21 libncurses-dev libncurses6 libncursesw6 libnet-dbus-perl libnet-http-perl libnet-smtp-ssl-perl libnet-ssleay-perl libnet1 libnetfilter-conntrack3 libnetplan0 libnettle7 libnewt0.52 libnfnetlink0 libnftnl11 libnghttp2-14 libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter libnginx-mod-mail libnginx-mod-stream libnl-3-200 libnorm1 libnotify4 libnpth0 libnspr4 libnss3 libntfs-3g883 libnuma1 libobjc-9-dev libobjc4 libodbc1 libogg0 libomp-11-dev libomp5-11 libonig5 libopenexr-dev libopenexr24 libp11-kit0 libpackagekit-glib2-18 libpam-cap libpam-modules-bin libpam-modules libpam-runtime libpam0g libpango-1.0-0 libpangocairo-1.0-0 libpangoft2-1.0-0 libpaper-utils libpaper1 libparted-fs-resize0 libparted2 libpcap0.8 libpci3 libpciaccess0 libpcre16-3 libpcre2-16-0 libpcre2-32-0 libpcre2-8-0 libpcre2-dev libpcre2-posix2 libpcre2-posix3 libpcre3-dev libpcre32-3 libpcre3 libpcrecpp0v5 libperl5.30 libpfm4 libpgm-5.2-0 libpipeline1 libpixman-1-0 libpixman-1-dev libplymouth5 libpng-dev libpng16-16 libpolkit-agent-1-0 libpolkit-gobject-1-0 libpopt0 libpq-dev libpq5 libprocps8 libprotobuf-c1 libprotobuf17 libproxy1v5 libpsl5 libpthread-stubs0-dev libqdbm14 libqmi-glib5 libqmi-proxy libquadmath0 librabbitmq4 libre2-5 libreadline-dev libreadline5 libreadline8 librest-0.7-0 libroken18-heimdal librpm8 librpmbuild8 librpmio8 librpmsign8 librsvg2-2 librsvg2-common librsvg2-dev librtmp1 libruby2.7 libsasl2-2 libsasl2-modules-db libsasl2-modules libsctp1 libseccomp2 libsecret-1-0 libsecret-1-dev libsecret-common libselinux1-dev libselinux1 libsemanage-common libsemanage1 libsensors-config libsensors5 libsepol1-dev libsepol1 libserf-1-1 libsgutils2-2 libsigsegv2 libslang2 libsm-dev libsm6 libsmartcols1 libsmbios-c2 libsnappy1v5 libsnmp-base libsnmp35 libsodium23 libsoup-gnome2.4-1 libsoup2.4-1 libsqlite3-0 libsqlite3-dev libss2 libssh-4 libssh2-1 libssl1.1 libstdc++-10-dev libstdc++-9-dev libstdc++6 libstemmer0d libsvn1 libsybdb5 libtalloc2 libtasn1-6 libtbb2 libtcl8.6 libtdb1 libtevent0 libtext-charwidth-perl libtext-iconv-perl libtext-unidecode-perl libtext-wrapi18n-perl libthai-data libthai0 libtidy5deb1 libtie-ixhash-perl libtiff-dev libtiff5 libtiffxx5 libtimedate-perl libtinfo-dev libtinfo5 libtinfo6 libtinyxml2-6a libtk8.6 libtommath1 libtool libtry-tiny-perl libtsan0 libtss2-esys0 libtypes-serialiser-perl libu2f-udev libubsan1 libuchardet0 libucl1 libudev1 libudisks2-0 libunistring2 libunwind8 liburcu6 liburi-perl libusb-1.0-0 libutempter0 libutf8proc2 libuuid1 libuv1 libvolume-key1 libvorbis0a libvorbisfile3 libvpx6 libvulkan1 libwayland-client0 libwayland-cursor0 libwayland-egl1 libwayland-server0 libwbclient0 libwebp6 libwebpmux3 libwind0-heimdal libwmf-dev libwmf0.2-7 libwrap0 libwww-perl libwww-robotrules-perl libwxbase3.0-0v5 libwxgtk3.0-gtk3-0v5 libx11-6 libx11-data libx11-dev libx11-protocol-perl libx11-xcb1 libxau-dev libxau6 libxaw7 libxcb-dri2-0 libxcb-dri3-0 libxcb-glx0 libxcb-present0 libxcb-render0-dev libxcb-render0 libxcb-shape0 libxcb-shm0-dev libxcb-shm0 libxcb-sync1 libxcb-xfixes0 libxcb1-dev libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxdmcp-dev libxdmcp6 libxext-dev libxext6 libxfixes3 libxfont2 libxft-dev libxft2 libxi6 libxinerama1 libxkbcommon0 libxkbfile-dev libxkbfile1 libxml-libxml-perl libxml-namespacesupport-perl libxml-parser-perl libxml-sax-base-perl libxml-sax-perl libxml-twig-perl libxml-xpathengine-perl libxml2-dev libxmlb1 libxmlrpc-epi0 libxmlsec1-openssl libxmlsec1 libxmu6 libxmuu1 libxpm4 libxrandr2 libxrender-dev libxrender1 libxshmfence1 libxslt1.1 libxss1 libxt-dev libxt6 libxtables12 libxtst6 libxv1 libxxf86dga1 libxxf86vm1 libyajl2 libyaml-0-2 libz3-4 libz3-dev libzen0v5 libzip4 libzmq5 libzstd1 linux-azure-5.13-cloud-tools-5.13.0-1022 linux-azure-5.13-headers-5.13.0-1022 linux-azure-5.13-tools-5.13.0-1022 linux-azure linux-base-sgx linux-base linux-cloud-tools-5.13.0-1022-azure linux-cloud-tools-azure linux-cloud-tools-common linux-headers-5.13.0-1022-azure linux-headers-azure linux-image-5.13.0-1022-azure linux-image-azure linux-libc-dev linux-modules-5.13.0-1022-azure linux-tools-5.13.0-1022-azure linux-tools-azure linux-tools-common lld-10 lld-11 lld-12 lldb-11 llvm-10-dev llvm-10-runtime llvm-10-tools llvm-10 llvm-11-dev llvm-11-runtime llvm-11-tools llvm-11 llvm-12-dev llvm-12-linker-tools llvm-12-runtime llvm-12-tools llvm-12 locales login logrotate logsave lsb-base lsb-release lshw lsof lsscsi ltrace lvm2 lxd-agent-loader lz4 m4 make man-db manpages mawk mdadm mecab-ipadic-utf8 mecab-ipadic mecab-utils mediainfo mercurial-common mercurial mime-support mlock moby-buildx moby-cli moby-compose moby-containerd moby-engine moby-runc modemmanager mokutil mongodb-database-tools mongodb-mongosh mongodb-org-database-tools-extra mongodb-org-database mongodb-org-mongos mongodb-org-server mongodb-org-shell mongodb-org-tools mongodb-org mono-4.0-gac mono-4.0-service mono-complete mono-csharp-shell mono-devel mono-gac mono-llvm-support mono-llvm-tools mono-mcs mono-roslyn mono-runtime-common mono-runtime-sgen mono-runtime mono-utils mono-xbuild mono-xsp4-base mono-xsp4 monodoc-base monodoc-http monodoc-manual motd-news-config msbuild-libhostfxr msbuild-sdkresolver msbuild msodbcsql17 mssql-tools mtr-tiny multipath-tools mysql-client-8.0 mysql-client-core-8.0 mysql-client mysql-common mysql-server-8.0 mysql-server-core-8.0 mysql-server nano ncurses-base ncurses-bin ncurses-term net-tools netbase netcat-openbsd netcat netplan.io netstandard-targeting-pack-2.1 networkd-dispatcher nginx-common nginx-core nginx ntfs-3g nuget odbcinst1debian2 odbcinst open-iscsi open-vm-tools openssh-client openssh-server openssh-sftp-server openssl os-prober overlayroot p11-kit-modules p11-kit p7zip-full p7zip-rar p7zip packagekit-tools packagekit packages-microsoft-prod parallel parted pass passwd pastebinit patch patchelf pci.ids pciutils perl-base perl-modules-5.30 perl-openssl-defaults perl pgdg-keyring php-common php-pear php7.4-amqp php7.4-apcu php7.4-bcmath php7.4-bz2 php7.4-cgi php7.4-cli php7.4-common php7.4-curl php7.4-dba php7.4-dev php7.4-enchant php7.4-fpm php7.4-gd php7.4-gmp php7.4-igbinary php7.4-imagick php7.4-imap php7.4-interbase php7.4-intl php7.4-json php7.4-ldap php7.4-mbstring php7.4-memcache php7.4-memcached php7.4-mongodb php7.4-msgpack php7.4-mysql php7.4-odbc php7.4-opcache php7.4-pcov php7.4-pgsql php7.4-phpdbg php7.4-pspell php7.4-readline php7.4-redis php7.4-snmp php7.4-soap php7.4-sqlite3 php7.4-sybase php7.4-tidy php7.4-xdebug php7.4-xml php7.4-xmlrpc php7.4-xsl php7.4-yaml php7.4-zip php7.4-zmq php7.4 php8.0-amqp php8.0-apcu php8.0-bcmath php8.0-bz2 php8.0-cgi php8.0-cli php8.0-common php8.0-curl php8.0-dba php8.0-dev php8.0-enchant php8.0-fpm php8.0-gd php8.0-gmp php8.0-igbinary php8.0-imagick php8.0-imap php8.0-interbase php8.0-intl php8.0-ldap php8.0-mbstring php8.0-memcache php8.0-memcached php8.0-mongodb php8.0-msgpack php8.0-mysql php8.0-odbc php8.0-opcache php8.0-pcov php8.0-pgsql php8.0-phpdbg php8.0-pspell php8.0-readline php8.0-redis php8.0-snmp php8.0-soap php8.0-sqlite3 php8.0-sybase php8.0-tidy php8.0-xdebug php8.0-xml php8.0-xsl php8.0-yaml php8.0-zip php8.0-zmq php8.0 php8.1-amqp php8.1-apcu php8.1-bcmath php8.1-bz2 php8.1-cgi php8.1-cli php8.1-common php8.1-curl php8.1-dba php8.1-dev php8.1-enchant php8.1-fpm php8.1-gd php8.1-gmp php8.1-igbinary php8.1-imagick php8.1-imap php8.1-interbase php8.1-intl php8.1-ldap php8.1-mbstring php8.1-memcache php8.1-memcached php8.1-mongodb php8.1-msgpack php8.1-mysql php8.1-odbc php8.1-opcache php8.1-pcov php8.1-pgsql php8.1-phpdbg php8.1-pspell php8.1-readline php8.1-redis php8.1-snmp php8.1-soap php8.1-sqlite3 php8.1-sybase php8.1-tidy php8.1-xdebug php8.1-xml php8.1-xsl php8.1-yaml php8.1-zip php8.1-zmq php8.1 pigz pinentry-curses pkg-config plymouth-theme-ubuntu-text plymouth podman-machine-cni podman-plugins podman policykit-1 pollinate popularity-contest postgresql-14 postgresql-client-14 postgresql-client-common postgresql-common powermgmt-base powershell procps psmisc publicsuffix r-base-core r-base-dev r-base-html r-base r-cran-boot r-cran-class r-cran-cluster r-cran-codetools r-cran-foreign r-cran-kernsmooth r-cran-lattice r-cran-mass r-cran-matrix r-cran-mgcv r-cran-nlme r-cran-nnet r-cran-rpart r-cran-spatial r-cran-survival r-doc-html r-recommended rake readline-common referenceassemblies-pcl ri rpm-common rpm2cpio rpm rsyslog ruby-dev ruby-full ruby-minitest ruby-net-telnet ruby-power-assert ruby-test-unit ruby-xmlrpc ruby2.7-dev ruby2.7-doc ruby2.7 ruby rubygems-integration run-one sbsigntool screen secureboot-db sensible-utils session-manager-plugin sg3-utils-udev sg3-utils shared-mime-info shellcheck shim-signed shtool skopeo slirp4netns snmp software-properties-common sosreport sound-theme-freedesktop sphinxsearch sqlite3 ssh-import-id ssh sshpass ssl-cert strace subversion swig4.0 swig sysstat sysvinit-utils tar tcl8.6 tcl tcpdump telnet temurin-11-jdk temurin-17-jdk temurin-8-jdk tex-common texinfo thin-provisioning-tools time tk8.6 tk tmux tpm-udev tzdata ucf udev udisks2 ufw uidmap unixodbc-dev unixodbc unzip update-manager-core update-notifier-common upx-ucl usb-modeswitch-data usb-modeswitch usb.ids usbutils util-linux uuid-dev uuid-runtime vim-common vim-runtime vim-tiny vim walinuxagent whiptail x11-common x11-utils x11-xkb-utils x11-xserver-utils x11proto-core-dev x11proto-dev x11proto-xext-dev xauth xdg-user-dirs xdg-utils xfsprogs xkb-data xorg-sgml-doctools xorriso xserver-common xtrans-dev xul-ext-ubufox xvfb xxd xz-utils zerofree zlib1g zsync
          sudo -E apt-get update
          sudo -E apt install bc bison build-essential ccache curl flex g++-multilib gcc-multilib git gnupg gperf imagemagick lib32ncurses5-dev lib32readline-dev lib32z1-dev liblz4-tool libncurses5 libncurses5-dev libsdl1.2-dev libssl-dev libxml2 libxml2-utils lzop pngcrush rsync schedtool squashfs-tools xsltproc zip zlib1g-dev openjdk-8-jdk wget -y
          sudo -E apt-get -y autoremove --purge
          sudo -E apt-get clean
          sudo rm -rf /usr/local/lib/heroku /usr/local/lib/node_modules /usr/local/lib/android /usr/local/share/chromium /usr/share/dotnet /usr/local/share/phantomjs* /usr/local/share/*driver /usr/local/share/vcpkg /etc/mysql /etc/php /etc/skel /etc/apt/sources.list.d ~/.dotnet ~/runners/*.tgz
          sudo sh -c "curl https://storage.googleapis.com/git-repo-downloads/repo > /usr/bin/repo"
          sudo chmod a+x /usr/bin/repo
          
      - name: Maximize build space
        uses: easimon/maximize-build-space@master
        with:
          root-reserve-mb: 64
          swap-size-mb: 1024
          remove-dotnet: 'true'
          remove-haskell: 'true'
          remove-android: 'true'
              
      - name: Pull codes
        run: |
          git config --global user.email "actions@github.com"
          git config --global user.name "Github Action"
          mkdir lineage
          cd lineage
          repo init --depth=1 -u https://github.com/LineageOS/android.git -b cm-14.1
          echo "======start repo sync======"
          repo sync -c -f --no-tags --no-clone-bundle -j 8
          while [ $? = 1 ]; do
              echo "======sync failed, re-sync again======"
              sleep 3
              repo sync -c -f --no-tags --no-clone-bundle -j 8
          done
          git clone https://github.com/Jakesoso/android_device_oppo_A37-los14.1.git -b cm-14.1 --depth=1 device/oppo/A37
          git clone https://github.com/peasoft/android_vendor_oppo_A37 --depth=1 vendor/oppo/A37
          find . -name ".git"  | xargs rm -rf
          rm -rf .repo
          rm -rf device/oppo/A37/.github device/oppo/A37/build.sh device/oppo/A37/README.md
          mkdir treelog
          tree -L 5 -o treelog/tree.txt
          tree -L 5 -n -o treelog/treen.txt

        shell: bash
        
      - name : Upload Logs
        uses: actions/upload-artifact@master
        with:
          name: lineageos-source-tree
          path: lineage/treelog
      
      - name: Build Lineage OS
        run: |
          source build/envsetup.sh
          croot
          brunch A37
        
      - name : Upload ROM
        uses: actions/upload-artifact@master
        with:
          name: lineageos-build-oppo-A37
          path: lineage/out